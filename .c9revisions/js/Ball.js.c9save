{"ts":1358099884574,"silentsave":true,"restoring":false,"patch":[[]],"length":0}
{"contributors":[],"silentsave":true,"ts":1358099888682,"patch":[[{"diffs":[[1,"//-----------------------------------\r\n// Class CBall : manage the ball\r\n//-----------------------------------\r\n/**\r\n * @author RX\r\n */\r\nCBall = function (inRadius)\r\n{\r\n    var Geometry = new THREE.SphereGeometry ( inRadius, 20, 20 );\r\n\tvar Material = new THREE.MeshPhongMaterial( { color: 0xFFFFFF } );\r\n\tthis.m_fRadius = inRadius;\r\n\tthis.m_Mesh = new THREE.Mesh( Geometry, Material );\r\n\tthis.m_Velocity = 1;\r\n\tthis.m_Dir = new THREE.Vector3 (0, 0, 1);\r\n}\r\nCBall.prototype.init = function() {\r\n\tvar fAngle = -Math.PI / 4;\r\n\tfAngle = Math.random () * Math.PI * 2;\r\n\twhile (Math.abs (fAngle) < 0.1 || Math.abs (Math.PI - fAngle) < 0.1) {\r\n\t\tfAngle = Math.random () * Math.PI * 2;\r\n\t}\r\n\tthis.m_Dir.x = Math.cos(fAngle);\r\n\tthis.m_Dir.y = 0;\r\n\tthis.m_Dir.z = Math.sin(fAngle);\r\n}\r\nCBall.prototype.move = function(deltaTime, collisions) {\r\n\tvar fAdvance  = this.m_Velocity * deltaTime;\r\n\tif (fAdvance != 0) {\r\n\t\tvar vPosStart = new THREE.Vector3 (this.m_Mesh.position.x, this.m_Mesh.position.y, this.m_Mesh.position.z);\r\n\t\tvar vPosStop = new THREE.Vector3 (vPosStart.x + this.m_Dir.x * fAdvance, vPosStart.y + this.m_Dir.y * fAdvance, vPosStart.z + this.m_Dir.z * fAdvance);\r\n\t\tif (collisions.collide (vPosStart, vPosStop, this)) {\r\n\t\t\t// Il y a eu collision : il faut recalculer la direction\r\n\t\t\tthis.m_Dir.x = vPosStop.x - vPosStart.x;\r\n\t\t\tthis.m_Dir.y = vPosStop.y - vPosStart.y;\r\n\t\t\tthis.m_Dir.z = vPosStop.z - vPosStart.z;\r\n\t\t\tthis.m_Dir.normalize ();\r\n\t\t}\r\n\t\tthis.m_Mesh.position.x = vPosStop.x;\r\n\t\tthis.m_Mesh.position.y = vPosStop.y;\r\n\t\tthis.m_Mesh.position.z = vPosStop.z;\r\n\t}\r\n\treturn this\r\n}\r\nCBall.prototype.addVelocity = function(x, y, z) {\r\n\tthis.m_Dir.x += x;\r\n\tthis.m_Dir.y += y;\r\n\tthis.m_Dir.z += z;\r\n\tthis.m_Dir.normalize ();\r\n}"]],"start1":0,"start2":0,"length1":0,"length2":1741}]],"length":1741,"saved":false}
